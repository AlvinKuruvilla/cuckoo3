<div id="tab-intelmq" hidden>
  {% call ui_box(title="IntelMQ", has_padding=False, collapsible=False) %}

    {# {{ render_dict({data: report.intelmq}) }} #}

    <table class="table has-sticky-header">
      <thead>
        <tr>
          <th>Provider</th>
          <th>Type</th>
          <th>IOC</th>
          <th>Taxonomy</th>
          <th>Time Source</th>
          <th>Time Observation</th>
        </tr>
      </thead>
      <tbody>
        {% for result in report.intelmq %}
          <tr>
            <td>
              <p class="has-text-weight-heavy no-margin-y has-text-small">{{ result.feed_provider }}</p>
              <p class="no-margin-bottom has-text-small">{{ result.feed_name }}</p>
            </td>
            <td>{{ result.classification_type }}</td>
            <td class="is-wrapped has-ellipsis">{{ result.ioc }}</td>
            <td>{{ result.classification_taxonomy }}</td>
            <td class="is-mini">{{ result.time_source|formatisodatetime }}</td>
            <td class="is-mini">{{ result.time_observation|formatisodatetime }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    {#
      {% for result in report.intelmq %}
        <div class="box has-background-light">
          <table class="table has-border">
            <tr>
              <td class="has-text-right has-text-bold is-medium">Feed provider</td>
              <td class="has-text-wrapped is-monospace">{{ result.feed_provider }}</td>
            </tr>
            <tr>
              <td class="has-text-right has-text-bold is-medium">Feed name</td>
              <td class="has-text-wrapped is-monospace">{{ result.feed_name }}</td>
            </tr>
            <tr>
              <td class="has-text-right has-text-bold is-medium">Type</td>
              <td class="has-text-wrapped is-monospace">{{ result.classification_type }}</td>
            </tr>
            <tr>
              <td class="has-text-right has-text-bold is-medium">IOC</td>
              <td class="has-text-wrapped is-monospace">{{ result.ioc }}</td>
            </tr>
            <tr>
              <td class="has-text-right has-text-bold is-medium">Taxonomy</td>
              <td class="has-text-wrapped is-monospace">{{ result.classification_taxonomy }}</td>
            </tr>
            <tr>
              <td class="has-text-right has-text-bold is-medium">Time source</td>
              <td class="has-text-wrapped is-monospace">{{ result.time_source }}</td>
            </tr>
            <tr>
              <td class="has-text-right has-text-bold is-medium">Time source</td>
              <td class="has-text-wrapped is-monospace">{{ result.time_observation }}</td>
            </tr>
          </table>
        </div>
      {% endfor %}
    #}
  {% endcall %}
</div>

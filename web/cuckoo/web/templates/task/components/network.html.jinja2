{#
  Data-To-View pluralization. This dictionary ensures some control over dynamically
  rendered data views.

  set is_active: True for the active page to initialize on
  set ui_label to replace original key name with a humanized version
#}
{% set network_view_configuration = {
  'host': {
    'is_active': True,
    'ui_label': 'Host'
  },
  'udp': {
    'ui_label': 'UDP'
  },
  'dns': {
    'ui_label': 'DNS'
  },
  'domain': {
    'ui_label': 'Domain'
  },
  'tcp': {
    'ui_label': 'TCP'
  },
  'http': {
    'ui_label': 'HTTP'
  }
} %}

{% call ui_box(title="Network analysis", collapsed=False, has_padding=False) %}
  <nav class="tabbar no-margin-bottom" data-enhance>
    {% for key in report.network %}
      {% set view = network_view_configuration[key] | default({}) %}
      <a class="tabbar-link {% if view.is_active %}is-active{% endif %}" href="#network-analysis-{{ key }}">{{ view.ui_label | default(key) }}</a>
    {% endfor %}
  </nav>
  <div id="network-analysis-host" {% if not network_view_configuration.host.is_active %}hidden{% endif %}>
    {{ network_view_configuration.host.ui_label }}
  </div>
  <div class="box no-margin-y has-background-light" id="network-analysis-udp" {% if not network_view_configuration.udp.is_active %}hidden{% endif %}>
    {% for udp in report.network.udp %}
      <div class="columns is-justified box has-shadow is-vcenter">
        <div class="column is-full has-margin-bottom has-text-center">{{ udp.ts }}</div>
        <div class="column is-fill has-text-right is-monospace">{{ udp.srcip }}:{{ udp.srcport }}</div>
        <div class="column is-auto no-line-break">
          <span class="tag is-rounded is-monospace no-padding-x">
            <span class="icon"><i class="fas fa-chevron-right"></i></span>
            {{ udp.size }}
            <span class="icon"><i class="fas fa-chevron-right"></i></span>
          </span>
        </div>
        <div class="column is-fill is-monospace">{{ udp.dstip }}:{{ udp.dstport }}</div>
      </div>
    {% endfor %}
  </div>
  <div id="network-analysis-dns" {% if not network_view_configuration.dns.is_active %}hidden{% endif %}>
    {{ network_view_configuration.dns.ui_label }}
  </div>
  <div id="network-analysis-domain" {% if not network_view_configuration.domain.is_active %}hidden{% endif %}>
    {{ network_view_configuration.domain.ui_label }}
  </div>
  <div id="network-analysis-tcp" {% if not network_view_configuration.tcp.is_active %}hidden{% endif %}>
    {{ network_view_configuration.tcp.ui_label }}
  </div>
  <div id="network-analysis-http" {% if not network_view_configuration.http.is_active %}hidden{% endif %}>
    {{ network_view_configuration.http.ui_label }}
  </div>
{% endcall %}

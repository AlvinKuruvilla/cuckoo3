{% extends "base.html.jinja2" %}
{% set active_page = "submit" %}
{% set active_level = 'settings' %}
{% set title = "Configure submission" %}

{# custom javascript with specific functionality for this page. note: it uses functionalities defined in ui.js #}
{% block page_script %}
  <script>
    (function() {
      // when available, store the PUT url in this application scope for access
      // in the settings js file.
      window.Application = Object.assign(window.Application || {}, {
        analysis_id: "{{ analysis_id }}"
      });
    }());
  </script>
  <script type="text/javascript" src="{{ static('js/submit.settings.js') }}"></script>
{% endblock %}

{% block body %}
  {% include "submit/partial/tabbar.html.jinja2" %}
  <section class="section">
    <div class="container">
      <div class="columns is-divided">
        {# Sample information #}
        <div class="column">
          {% if unpacked.children|length > 0 %}
            <div class="box has-shadow">
              <div class="control is-checkable">
                <input type="checkbox" id="toggle-disabled" checked />
                <label class="label" for="toggle-disabled">Only show interesting files <span id="count">(<span>0</span> hidden from view)</span></label>
              </div>
            </div>
          {% endif %}
          <div class="box has-shadow no-padding-x">
            <div class="box is-medium has-background-light has-margin-x no-margin-y">
              <div class="columns is-vcenter {% if not unpacked.selectable %}is-disabled{% endif %}">
                <div class="column no-margin-x">
                  <div class="control is-checkable">
                    <input type="radio" id="toggle-disabled" name="selected-file" value="{{ unpacked.id }}" {% if unpacked.selected %}checked{% endif %} />
                    <label class="label" for="toggle-disabled"></label>
                  </div>
                </div>
                <div class="column no-margin">
                  <span class="icon is-big"><i class="fas fa-file-archive"></i></span>
                </div>
                <div class="column">
                  <h3 class="no-margin-y">{{ unpacked.filename }}</h3>
                  <ul class="list is-horizontal has-text-small no-margin">
                    <li>{{ unpacked.finger.magic_human }}</li>
                    <li>{{ unpacked.size | filesizeformat }}</li>
                  </ul>
                </div>
              </div>
            </div>
            {% if unpacked.children|length > 0 %}
              {% include "submit/partial/filetree.html.jinja2" %}
            {% endif %}
          </div>
        </div>
        {# Options / profile box #}
        <div class="column">
          <div class="box has-shadow no-padding-x">
            <nav class="tabbar" data-enhance>
              <a href="#options-form" class="tabbar-link is-active">Options</a>
            </nav>
            <div class="box no-padding">
              <div id="options-form">{% include "submit/partial/options.html.jinja2" %}</div>
            </div>
          </div>
          <div class="box has-shadow" id="conclude-analysis">
            <!-- inject any messages here -->
            <div class="columns is-between is-vcenter">
              <div class="column">
                <p class="no-margin-y">
                  <span class="icon">
                    <i class="fas fa-check"></i>
                  </span>
                  Proceed to analysis
                </p>
              </div>
              <div class="column">
                <button class="button"id="reset-analysis">Reset</button>
                <button class="button is-blue" id="start-analysis">Start</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
{% endblock %}

<h4 class="label is-set-title has-margin-x has-padding clear-box">
  Global analysis options
  <a class="is-link pull-right" href="#" title="Go to documentation"><i class="fas fa-book"></i></a>
</h4>
<div class="box has-background-light has-margin-x">
  <div class="columns is-divided">
    <div class="column">
      <div class="field">
        {# Timeout #}
        <label class="label">Timeout</label>
        <div class="control is-checkable">
          <input type="radio" value="30" id="to-30" name="timeout" />
          <label for="to-30">30 seconds</label>
        </div>
        <div class="control is-checkable">
          <input type="radio" value="60" id="to-60" name="timeout" checked />
          <label for="to-60">1 minute</label>
        </div>
        <div class="control is-checkable">
          <input type="radio" value="120" id="to-120" name="timeout" />
          <label for="to-120">2 minutes</label>
        </div>
        <div class="control is-checkable">
          <input type="radio" value="" id="to-custom" name="timeout" />
          <label class="label" for="to-custom">
            <input type="number" placeholder="Custom (in seconds)" class="input" id="to-custom-value" />
          </label>
        </div>
        <p class="has-text-small has-half-opacity no-margin-bottom">
          <span class="icon">
            <i class="fas fa-info-circle"></i>
          </span>
          Time in seconds before VM can shut down
        </p>
      </div>
    </div>
    <div class="column">
      <div class="field">
        {# priority #}
        <label class="label" for="priority">Priority</label>
        <div class="control is-select">
          <select name="priority" class="input" id="priority">
            <option value="1" selected>Low</option>
            <option value="2">Medium</option>
            <option value="3">High</option>
          </select>
        </div>
        <p class="has-text-small has-half-opacity">
          <span class="icon">
            <i class="fas fa-info-circle"></i>
          </span>
          Prioritizes task in queue if necessary
        </p>
      </div>
      <!-- <div class="field">
        <div class="multi-toggle">
          <div class="control is-checkable">
            <input
          </div>
          <div class="control is-checkable"></div>
          <div class="control is-checkable"></div>
        </div>
      </div> -->
      <div class="field">
        <label class="label has-margin-top" for="routing">Network routing</label>

        <div class="field columns is-gapless" data-route-type>
          <div class="column is-full">
            <div class="control is-checkable">
              <input type="radio" value="" id="route-none" name="route" checked />
              <label for="route-none">None</label>
            </div>
          </div>
          <div class="control is-checkable">
            <input type="radio" value="drop" id="route-drop" name="route" {% if not 'drop' in possible_settings.routes.available %}disabled{% endif %} />
            <label for="route-drop">Drop</label>
          </div>
          <div class="control is-checkable">
            <input type="radio" value="internet" id="route-internet" name="route" {% if not 'internet' in possible_settings.routes.available %}disabled{% endif %} />
            <label for="route-internet">Internet</label>
          </div>
          <div class="control is-checkable">
            <input type="radio" value="vpn" id="route-vpn" name="route" {% if not 'vpn' in possible_settings.routes.available %}disabled{% endif %} />
            <label for="route-vpn">VPN</label>
          </div>
        </div>

        <div class="field is-inline no-padding-y no-padding-right no-margin-top" id="select-vpn-country" data-route-country-field hidden>
          <label class="label">Country</label>
          <div class="control is-select">
            <select class="input" name="country" id="country" data-route-country>
              <option>First available</option>
              <optgroup label="Available countries">
                {% for country in possible_settings.routes.vpn.countries %}
                  <option value="{{ country }}">{{ country }}</option>
                {% endfor %}
              </optgroup>
            </select>
          </div>
        </div>
        <p class="has-text-small has-half-opacity">
          <span class="icon">
            <i class="fas fa-info-circle"></i>
          </span>
          Configure protocol for internet usage
        </p>
      </div>
      {% if analysis.category == 'url' %}
        <div class="field">
          {# browser #}
          <label class="label">Browser</label>
          <div class="control is-select">
            <select class="input" name="browser">
              <option value="default">Default</option>
              {% for browser in possible_settings.browser %}
                <option value="{{browser}}">{{ browser }}</option>
              {% endfor %}
            </select>
          </div>
          <p class="has-text-small has-half-opacity">
            <span class="icon">
              <i class="fas fa-info-circle"></i>
            </span>
            Choose browser to open the submitted URL in.
          </p>
        </div>
      {% endif %}
    </div>
  </div>
</div>

<div class="box has-background-light has-margin-x">

  <a class="button is-beveled has-margin-x" onclick="toggleVisibility(this.parentNode.querySelectorAll('.field'));">Toggle extra options</a>

  <div class="field has-margin-x" hidden>
    <div class="control is-checkable">
      <input type="checkbox" id="orig-filename" name="orig-filename" />
      <label for="orig-filename">Use original filename</label>
      <p class="has-text-small has-half-opacity no-margin-bottom">
        <span class="icon">
          <i class="fas fa-info-circle"></i>
        </span>
        Ignore detected file type by the identification stage
      </p>
    </div>
  </div>

  <div class="field has-margin-x" hidden>
    <div class="control">
      <label for="command" class="label">Launch commands:</label>
      <div class="control">
        <input class="input" type="text" name="command" id="command" />
      </div>
      <p class="has-text-small has-half-opacity no-margin-bottom">
        <span class="icon">
          <i class="fas fa-info-circle"></i>
        </span>
        Command that is used to launch the target. Use <span data-click-to-copy class="is-monospace has-text-red">%PAYLOAD%</span> where the target name should be on launch
      </p>
    </div>
  </div>

</div>
